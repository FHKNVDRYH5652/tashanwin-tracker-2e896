<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Loss Recover — Admin Panel</title>
<style>
  body{margin:0;font-family:Inter,Segoe UI,Arial;background:#071022;color:#f0f6ff}
  header{padding:16px;text-align:center;background:#0f1724;font-weight:700;font-size:1.2rem}
  .wrap{max-width:800px;margin:18px auto;padding:12px}
  .card{background:#0f1724;border-radius:12px;padding:16px;margin-bottom:14px}
  .btn{padding:8px 12px;border:none;border-radius:8px;cursor:pointer;font-weight:700}
  .btn.approve{background:linear-gradient(90deg,#00d2a8,#00a6ff);color:#012}
  .btn.reject{background:#444;color:#fff}
  .small{color:#9fb0d6;font-size:0.9rem}
  .row{display:flex;justify-content:space-between;align-items:center;margin:6px 0;padding:8px;border-radius:8px;background:rgba(255,255,255,0.03)}
</style>
</head>
<body>
<header>Loss Recover — Admin Panel</header>
<div class="wrap">

  <div class="card">
    <h3>Pending UTR Requests</h3>
    <div id="pendingList"></div>
  </div>

  <div class="card">
    <h3>Approved Records</h3>
    <div id="approvedList"></div>
  </div>

</div>

<script>
function loadPending(){
  const list = document.getElementById('pendingList');
  list.innerHTML = '';
  for(let i=0;i<localStorage.length;i++){
    const k = localStorage.key(i);
    if(k.startsWith('pending_')){
      try{
        const info = JSON.parse(localStorage.getItem(k));
        const div = document.createElement('div');
        div.className = 'row';
        div.innerHTML = `
          <div>
            <div><b>UTR:</b> ${info.utr}</div>
            <div class="small">Plan ₹${info.plan} | Deposit ₹${info.amount}</div>
          </div>
          <div>
            <button class="btn approve" onclick="approve('${info.utr}', ${info.amount}, ${info.plan})">Approve</button>
            <button class="btn reject" onclick="reject('${info.utr}')">Reject</button>
          </div>
        `;
        list.appendChild(div);
      }catch(e){}
    }
  }
  if(list.innerHTML===''){ list.innerHTML = '<div class="small">No pending requests</div>'; }
}

function loadApproved(){
  const box = document.getElementById('approvedList');
  box.innerHTML = '';
  for(let i=0;i<localStorage.length;i++){
    const k = localStorage.key(i);
    if(k.startsWith('approved_')){
      try{
        const info = JSON.parse(localStorage.getItem(k));
        const div = document.createElement('div');
        div.className = 'row';
        div.innerHTML = `<div><b>UTR:</b> ${info.utr}</div>
                         <div class="small">Plan ₹${info.plan} | Deposit ₹${info.amount}</div>`;
        box.appendChild(div);
      }catch(e){}
    }
  }
  if(box.innerHTML===''){ box.innerHTML = '<div class="small">No approvals yet</div>'; }
}

function approve(utr, amount, plan){
  const data = {utr: utr, amount: amount, plan: plan, ts: Date.now()};
  localStorage.setItem('approved_' + utr, JSON.stringify(data));
  localStorage.removeItem('pending_' + utr);
  alert('Approved UTR ' + utr);
  loadPending(); loadApproved();
}
function reject(utr){
  localStorage.removeItem('pending_' + utr);
  alert('Rejected UTR ' + utr);
  loadPending();
}

document.addEventListener('DOMContentLoaded', ()=>{ loadPending(); loadApproved(); });
</script>
</body>
</html>
